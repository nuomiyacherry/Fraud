{"remainingRequest":"D:\\工作项目\\部反诈\\node_modules\\babel-loader\\lib\\index.js!D:\\工作项目\\部反诈\\node_modules\\eslint-loader\\index.js??ref--13-0!D:\\工作项目\\部反诈\\src\\utils\\storage.js","dependencies":[{"path":"D:\\工作项目\\部反诈\\src\\utils\\storage.js","mtime":1598758375152},{"path":"D:\\工作项目\\部反诈\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\工作项目\\部反诈\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\工作项目\\部反诈\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/web.dom.iterable\";\nimport _typeof from \"D:\\\\\\u5DE5\\u4F5C\\u9879\\u76EE\\\\\\u90E8\\u53CD\\u8BC8\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/typeof\";\nimport _JSON$stringify from \"D:\\\\\\u5DE5\\u4F5C\\u9879\\u76EE\\\\\\u90E8\\u53CD\\u8BC8\\\\node_modules\\\\@babel\\\\runtime-corejs2/core-js/json/stringify\";\nimport _classCallCheck from \"D:\\\\\\u5DE5\\u4F5C\\u9879\\u76EE\\\\\\u90E8\\u53CD\\u8BC8\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"D:\\\\\\u5DE5\\u4F5C\\u9879\\u76EE\\\\\\u90E8\\u53CD\\u8BC8\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/createClass\";\nimport { on } from './dom';\nvar KEY = 'act_key_';\n\nvar Store =\n/*#__PURE__*/\nfunction () {\n  function Store(store) {\n    _classCallCheck(this, Store);\n\n    this.prefix = KEY;\n    store = store || 'sessionStorage';\n    this.store = window[store];\n  }\n\n  _createClass(Store, [{\n    key: \"set\",\n    value: function set(key, value, fn) {\n      this._setItem(key, value);\n\n      fn && fn();\n    }\n  }, {\n    key: \"_setItem\",\n    value: function _setItem(key, value) {\n      var setItemEvent = new Event('setItemEvent');\n      setItemEvent.oldValue = this.get(key);\n      setItemEvent.value = value;\n      setItemEvent.key = key;\n      window.dispatchEvent(setItemEvent);\n\n      try {\n        value = _JSON$stringify(value);\n      } catch (e) {// value = value\n      }\n\n      this.store.setItem(this.prefix + key, value);\n    }\n  }, {\n    key: \"watch\",\n    value: function watch(callback) {\n      // console.log(callback)\n      on(window, 'setItemEvent', callback);\n    }\n  }, {\n    key: \"get\",\n    value: function get(key, fn) {\n      if (!key) {\n        throw new Error('沒有找到key!');\n      }\n\n      if (_typeof(key) === 'object') {\n        throw new Error('key不能是一个对象');\n      }\n\n      var value = this.store.getItem(this.prefix + key);\n\n      if (value) {\n        try {\n          value = JSON.parse(value);\n        } catch (e) {// value = value\n        }\n\n        fn && fn();\n        return value;\n      }\n    }\n  }, {\n    key: \"remove\",\n    value: function remove(key) {\n      var _this = this;\n\n      if (toString.call(key) === '[object Array]') {\n        key.forEach(function (item, index) {\n          _this.store.removeItem(_this.prefix + item);\n        });\n      } else if (toString.call(key) === '[object String]') {\n        this.store.removeItem(this.prefix + key);\n      }\n    }\n  }, {\n    key: \"clear\",\n    value: function clear() {\n      this.store.clear();\n    }\n  }]);\n\n  return Store;\n}();\n\nexport default new Store(); // export const localStorage = new Store('localStorage')",{"version":3,"sources":["D:\\工作项目\\部反诈\\src\\utils\\storage.js"],"names":["on","KEY","Store","store","prefix","window","key","value","fn","_setItem","setItemEvent","Event","oldValue","get","dispatchEvent","e","setItem","callback","Error","getItem","JSON","parse","toString","call","forEach","item","index","removeItem","clear"],"mappings":";;;;;AAAA,SAASA,EAAT,QAAmB,OAAnB;AAEA,IAAMC,GAAG,GAAG,UAAZ;;IAEMC,K;;;AACJ,iBAAYC,KAAZ,EAAmB;AAAA;;AACjB,SAAKC,MAAL,GAAcH,GAAd;AACAE,IAAAA,KAAK,GAAGA,KAAK,IAAI,gBAAjB;AACA,SAAKA,KAAL,GAAaE,MAAM,CAACF,KAAD,CAAnB;AACD;;;;wBACGG,G,EAAKC,K,EAAOC,E,EAAI;AAClB,WAAKC,QAAL,CAAcH,GAAd,EAAmBC,KAAnB;;AAEAC,MAAAA,EAAE,IAAIA,EAAE,EAAR;AACD;;;6BACQF,G,EAAKC,K,EAAO;AACnB,UAAMG,YAAY,GAAG,IAAIC,KAAJ,CAAU,cAAV,CAArB;AACAD,MAAAA,YAAY,CAACE,QAAb,GAAwB,KAAKC,GAAL,CAASP,GAAT,CAAxB;AACAI,MAAAA,YAAY,CAACH,KAAb,GAAqBA,KAArB;AACAG,MAAAA,YAAY,CAACJ,GAAb,GAAmBA,GAAnB;AACAD,MAAAA,MAAM,CAACS,aAAP,CAAqBJ,YAArB;;AACA,UAAI;AACFH,QAAAA,KAAK,GAAG,gBAAeA,KAAf,CAAR;AACD,OAFD,CAEE,OAAOQ,CAAP,EAAU,CACV;AACD;;AACD,WAAKZ,KAAL,CAAWa,OAAX,CAAmB,KAAKZ,MAAL,GAAcE,GAAjC,EAAsCC,KAAtC;AACD;;;0BACKU,Q,EAAU;AACd;AACAjB,MAAAA,EAAE,CAACK,MAAD,EAAS,cAAT,EAAyBY,QAAzB,CAAF;AACD;;;wBACGX,G,EAAKE,E,EAAI;AACX,UAAI,CAACF,GAAL,EAAU;AACR,cAAM,IAAIY,KAAJ,CAAU,UAAV,CAAN;AACD;;AACD,UAAI,QAAOZ,GAAP,MAAe,QAAnB,EAA6B;AAC3B,cAAM,IAAIY,KAAJ,CAAU,YAAV,CAAN;AACD;;AACD,UAAIX,KAAK,GAAG,KAAKJ,KAAL,CAAWgB,OAAX,CAAmB,KAAKf,MAAL,GAAcE,GAAjC,CAAZ;;AACA,UAAIC,KAAJ,EAAW;AACT,YAAI;AACFA,UAAAA,KAAK,GAAGa,IAAI,CAACC,KAAL,CAAWd,KAAX,CAAR;AACD,SAFD,CAEE,OAAOQ,CAAP,EAAU,CACV;AACD;;AACDP,QAAAA,EAAE,IAAIA,EAAE,EAAR;AACA,eAAOD,KAAP;AACD;AACF;;;2BACMD,G,EAAK;AAAA;;AACV,UAAIgB,QAAQ,CAACC,IAAT,CAAcjB,GAAd,MAAuB,gBAA3B,EAA6C;AAC3CA,QAAAA,GAAG,CAACkB,OAAJ,CAAY,UAACC,IAAD,EAAOC,KAAP,EAAiB;AAC3B,UAAA,KAAI,CAACvB,KAAL,CAAWwB,UAAX,CAAsB,KAAI,CAACvB,MAAL,GAAcqB,IAApC;AACD,SAFD;AAGD,OAJD,MAIO,IAAIH,QAAQ,CAACC,IAAT,CAAcjB,GAAd,MAAuB,iBAA3B,EAA8C;AACnD,aAAKH,KAAL,CAAWwB,UAAX,CAAsB,KAAKvB,MAAL,GAAcE,GAApC;AACD;AACF;;;4BACO;AACN,WAAKH,KAAL,CAAWyB,KAAX;AACD;;;;;;AAGH,eAAe,IAAI1B,KAAJ,EAAf,C,CAEA","sourcesContent":["import { on } from './dom'\r\n\r\nconst KEY = 'act_key_'\r\n\r\nclass Store {\r\n  constructor(store) {\r\n    this.prefix = KEY\r\n    store = store || 'sessionStorage'\r\n    this.store = window[store]\r\n  }\r\n  set(key, value, fn) {\r\n    this._setItem(key, value)\r\n\r\n    fn && fn()\r\n  }\r\n  _setItem(key, value) {\r\n    const setItemEvent = new Event('setItemEvent')\r\n    setItemEvent.oldValue = this.get(key)\r\n    setItemEvent.value = value\r\n    setItemEvent.key = key\r\n    window.dispatchEvent(setItemEvent)\r\n    try {\r\n      value = JSON.stringify(value)\r\n    } catch (e) {\r\n      // value = value\r\n    }\r\n    this.store.setItem(this.prefix + key, value)\r\n  }\r\n  watch(callback) {\r\n    // console.log(callback)\r\n    on(window, 'setItemEvent', callback)\r\n  }\r\n  get(key, fn) {\r\n    if (!key) {\r\n      throw new Error('沒有找到key!')\r\n    }\r\n    if (typeof key === 'object') {\r\n      throw new Error('key不能是一个对象')\r\n    }\r\n    let value = this.store.getItem(this.prefix + key)\r\n    if (value) {\r\n      try {\r\n        value = JSON.parse(value)\r\n      } catch (e) {\r\n        // value = value\r\n      }\r\n      fn && fn()\r\n      return value\r\n    }\r\n  }\r\n  remove(key) {\r\n    if (toString.call(key) === '[object Array]') {\r\n      key.forEach((item, index) => {\r\n        this.store.removeItem(this.prefix + item)\r\n      })\r\n    } else if (toString.call(key) === '[object String]') {\r\n      this.store.removeItem(this.prefix + key)\r\n    }\r\n  }\r\n  clear() {\r\n    this.store.clear()\r\n  }\r\n}\r\n\r\nexport default new Store()\r\n\r\n// export const localStorage = new Store('localStorage')\r\n"]}]}