{"remainingRequest":"D:\\工作项目\\部反诈\\node_modules\\babel-loader\\lib\\index.js!D:\\工作项目\\部反诈\\node_modules\\eslint-loader\\index.js??ref--13-0!D:\\工作项目\\部反诈\\src\\utils\\map3d\\components\\tooltip\\index.js","dependencies":[{"path":"D:\\工作项目\\部反诈\\src\\utils\\map3d\\components\\tooltip\\index.js","mtime":1598758375191},{"path":"D:\\工作项目\\部反诈\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\工作项目\\部反诈\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\工作项目\\部反诈\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import _Array$isArray from \"D:\\\\\\u5DE5\\u4F5C\\u9879\\u76EE\\\\\\u90E8\\u53CD\\u8BC8\\\\node_modules\\\\@babel\\\\runtime-corejs2/core-js/array/is-array\";\nimport \"core-js/modules/es6.regexp.replace\";\nimport _Object$keys from \"D:\\\\\\u5DE5\\u4F5C\\u9879\\u76EE\\\\\\u90E8\\u53CD\\u8BC8\\\\node_modules\\\\@babel\\\\runtime-corejs2/core-js/object/keys\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.function.name\";\nimport _JSON$stringify from \"D:\\\\\\u5DE5\\u4F5C\\u9879\\u76EE\\\\\\u90E8\\u53CD\\u8BC8\\\\node_modules\\\\@babel\\\\runtime-corejs2/core-js/json/stringify\";\nimport _classCallCheck from \"D:\\\\\\u5DE5\\u4F5C\\u9879\\u76EE\\\\\\u90E8\\u53CD\\u8BC8\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"D:\\\\\\u5DE5\\u4F5C\\u9879\\u76EE\\\\\\u90E8\\u53CD\\u8BC8\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/createClass\";\nimport merge from 'lodash/merge';\nimport { setStyles, addClass, on, off } from '../../libs/dom';\nimport { defaultOptions } from './options';\nvar CLASS = 'map3d-tooltip';\n\nvar Tooltip =\n/*#__PURE__*/\nfunction () {\n  function Tooltip(context, options, event) {\n    _classCallCheck(this, Tooltip);\n\n    this.context = context;\n    this.event = event;\n    this.html = '';\n    this.options = merge({}, defaultOptions, options);\n    this.init();\n  }\n\n  _createClass(Tooltip, [{\n    key: \"init\",\n    value: function init() {\n      var div = this.tooltipEl;\n\n      if (!div) {\n        div = document.createElement('div');\n        addClass(div, CLASS);\n        this.tooltipEl = div;\n        this.context.el.appendChild(div);\n      }\n\n      var _this$options = this.options,\n          _this$options$positio = _this$options.position,\n          position = _this$options$positio === void 0 ? [] : _this$options$positio,\n          background = _this$options.background,\n          border = _this$options.border,\n          borderType = _this$options.borderType,\n          borderRadius = _this$options.borderRadius,\n          borderWidth = _this$options.borderWidth,\n          padding = _this$options.padding,\n          boxShadow = _this$options.boxShadow,\n          width = _this$options.width,\n          height = _this$options.height,\n          _this$options$textSty = _this$options.textStyle,\n          textStyle = _this$options$textSty === void 0 ? {} : _this$options$textSty,\n          transitionDuration = _this$options.transitionDuration,\n          extraCssText = _this$options.extraCssText,\n          color = textStyle.color,\n          fontStyle = textStyle.fontStyle,\n          fontWeight = textStyle.fontWeight,\n          fontFamily = textStyle.fontFamily,\n          fontSize = textStyle.fontSize,\n          lineHeight = textStyle.lineHeight,\n          whiteSpace = textStyle.whiteSpace;\n      setStyles(div, {\n        position: 'absolute',\n        left: position[0],\n        top: position[1],\n        width: \"\".concat(width, \"px\"),\n        height: \"\".concat(height, \"px\"),\n        background: background,\n        borderColor: border,\n        borderRadius: this.setMaxFourValues(borderRadius),\n        borderWidth: \"\".concat(borderWidth, \"px\"),\n        borderType: borderType,\n        padding: this.setMaxFourValues(padding),\n        display: 'none',\n        whiteSpace: whiteSpace,\n        boxShadow: boxShadow,\n        color: color,\n        fontStyle: fontStyle,\n        fontWeight: fontWeight,\n        fontFamily: fontFamily,\n        fontSize: \"\".concat(fontSize, \"px\"),\n        lineHeight: \"\".concat(lineHeight, \"px\"),\n        zIndex: 999,\n        transition: \"all \".concat(transitionDuration, \"ms linear\")\n      });\n\n      if (extraCssText) {\n        div.style.cssText += extraCssText;\n      }\n\n      on(div, 'mouseover', this.mouseover.bind(this));\n      on(div, 'mouseout', this.mouseout.bind(this));\n    }\n  }, {\n    key: \"mouseover\",\n    value: function mouseover() {\n      this.visible = this.options.enterable;\n    }\n  }, {\n    key: \"mouseout\",\n    value: function mouseout() {\n      this.visible = false;\n    }\n  }, {\n    key: \"destroy\",\n    value: function destroy() {\n      off(this.tooltipEl, 'mouseover', this.mouseover.bind(this));\n      off(this.tooltipEl, 'mouseout', this.mouseout.bind(this));\n    }\n  }, {\n    key: \"show\",\n    value: function show(params) {\n      var _this = this;\n\n      setTimeout(function (_) {\n        _this.tooltipEl.style.display = 'block';\n        _this.tooltipEl.innerHTML = _this.getHtml(_this.options.formatter, params);\n\n        _this.setPopperPos(params.event, _this.tooltipEl, _this.options);\n      }, this.options.showDelay);\n    }\n  }, {\n    key: \"hide\",\n    value: function hide(event) {\n      var _this2 = this;\n\n      setTimeout(function (_) {\n        !_this2.visible && (_this2.tooltipEl.style.display = 'none');\n      }, this.options.hideDelay);\n    }\n  }, {\n    key: \"getHtml\",\n    value: function getHtml(formatter, params) {\n      if (typeof formatter === 'function') return formatter(params);\n\n      if (!params.data || _JSON$stringify(params.data) === '{}') {\n        params.data = {\n          name: params.name\n        };\n      }\n\n      if (!params.data.value && formatter === defaultOptions.formatter) {\n        formatter = '{name}';\n      }\n\n      !params.data.name && (params.data.name = params.name);\n\n      _Object$keys(params.data).forEach(function (key) {\n        formatter = formatter.replace(\"{\".concat(key, \"}\"), params.data[key]);\n      });\n\n      return formatter;\n    }\n  }, {\n    key: \"setMaxFourValues\",\n    value: function setMaxFourValues(value) {\n      if (typeof value === 'number') return \"\".concat(value, \"px\");\n      if (_Array$isArray(value)) return value.map(function (item) {\n        return \"\".concat(item, \"px\");\n      }).join(', ');\n      return value;\n    }\n  }, {\n    key: \"setPopperPos\",\n    value: function setPopperPos(event, el) {\n      var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n      if (!el) return;\n      var _options$placement = options.placement,\n          placement = _options$placement === void 0 ? 'right' : _options$placement,\n          _options$offset = options.offset,\n          offset = _options$offset === void 0 ? [20, 20] : _options$offset,\n          pointCenter = options.pointCenter,\n          offsetX = event.offsetX,\n          offsetY = event.offsetY,\n          offsetWidth = el.offsetWidth,\n          offsetHeight = el.offsetHeight,\n          rect = el.parentNode.getBoundingClientRect(),\n          width = el.parentNode.offsetWidth,\n          height = el.parentNode.offsetHeight,\n          pl = offsetX - offsetWidth - offset[0],\n          plc = offsetX - offsetWidth / 2,\n          pr = offsetX + offset[0],\n          pt = offsetY - offsetHeight - offset[1],\n          ptc = offsetY - offsetHeight / 2,\n          pb = offsetY + offset[1];\n      var left, top;\n\n      if (placement === 'left') {\n        left = pl < 0 ? pr : pl;\n      } else if (placement === 'right') {\n        left = pr + offsetWidth > width ? pl : pr;\n      } else if (placement === 'top') {\n        top = pt < 0 ? pb : pt;\n      } else if (placement === 'bottom') {\n        top = pb + offsetHeight > height ? pt : pb;\n      }\n\n      if (placement === 'left' || placement === 'right') {\n        if (offsetY + offsetHeight / 2 > height) {\n          pointCenter && (left = plc);\n          top = pt;\n        } else if (offsetY - offsetHeight / 2 < 0) {\n          pointCenter && (left = plc);\n          top = pb + offsetHeight > height ? pt : pb;\n        } else {\n          top = pointCenter ? ptc : pb;\n        }\n      }\n\n      if (placement === 'top' || placement === 'btottom') {\n        if (offsetX + offsetWidth / 2 > width) {\n          left = pl;\n          pointCenter && (top = ptc);\n        } else if (offsetX - offsetWidth / 2 < 0) {\n          left = pr;\n          pointCenter && (top = ptc);\n        } else {\n          left = pointCenter ? plc : pr;\n        }\n\n        if (top === pb && top + offsetHeight > height || top < 0 && top === pt) {\n          pointCenter && (top = ptc);\n          left = left + offsetWidth > width ? pl : pr;\n        }\n      }\n\n      left < rect.left && (left = pr);\n      top < rect.top && (top = pb);\n      left + offsetWidth + rect.left > window.innerWidth && (left = pl);\n      top + offsetHeight + rect.top > window.innerHeight && (top = pt);\n      setStyles(el, {\n        left: left + 'px',\n        top: top + 'px'\n      });\n    }\n  }]);\n\n  return Tooltip;\n}();\n\nexport { Tooltip as default };",{"version":3,"sources":["D:\\工作项目\\部反诈\\src\\utils\\map3d\\components\\tooltip\\index.js"],"names":["merge","setStyles","addClass","on","off","defaultOptions","CLASS","Tooltip","context","options","event","html","init","div","tooltipEl","document","createElement","el","appendChild","position","background","border","borderType","borderRadius","borderWidth","padding","boxShadow","width","height","textStyle","transitionDuration","extraCssText","color","fontStyle","fontWeight","fontFamily","fontSize","lineHeight","whiteSpace","left","top","borderColor","setMaxFourValues","display","zIndex","transition","style","cssText","mouseover","bind","mouseout","visible","enterable","params","setTimeout","_","innerHTML","getHtml","formatter","setPopperPos","showDelay","hideDelay","data","name","value","forEach","key","replace","map","item","join","placement","offset","pointCenter","offsetX","offsetY","offsetWidth","offsetHeight","rect","parentNode","getBoundingClientRect","pl","plc","pr","pt","ptc","pb","window","innerWidth","innerHeight"],"mappings":"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","sourcesContent":["import merge from 'lodash/merge'\nimport { setStyles, addClass, on, off } from '../../libs/dom'\nimport { defaultOptions } from './options'\n\nconst CLASS = 'map3d-tooltip'\nexport default class Tooltip {\n  constructor(context, options, event) {\n    this.context = context\n    this.event = event\n\n    this.html = ''\n    this.options = merge({}, defaultOptions, options)\n    this.init()\n  }\n\n  init() {\n    let div = this.tooltipEl\n    if (!div) {\n      div = document.createElement('div')\n      addClass(div, CLASS)\n      this.tooltipEl = div\n      this.context.el.appendChild(div)\n    }\n    const {\n        position = [],\n        background,\n        border,\n        borderType,\n        borderRadius,\n        borderWidth,\n        padding,\n        boxShadow,\n        width,\n        height,\n        textStyle = {},\n        transitionDuration,\n        extraCssText\n      } = this.options,\n      {\n        color,\n        fontStyle,\n        fontWeight,\n        fontFamily,\n        fontSize,\n        lineHeight,\n        whiteSpace\n      } = textStyle\n    setStyles(div, {\n      position: 'absolute',\n      left: position[0],\n      top: position[1],\n      width: `${width}px`,\n      height: `${height}px`,\n      background,\n      borderColor: border,\n      borderRadius: this.setMaxFourValues(borderRadius),\n      borderWidth: `${borderWidth}px`,\n      borderType,\n      padding: this.setMaxFourValues(padding),\n      display: 'none',\n      whiteSpace,\n      boxShadow,\n      color,\n      fontStyle,\n      fontWeight,\n      fontFamily,\n      fontSize: `${fontSize}px`,\n      lineHeight: `${lineHeight}px`,\n      zIndex: 999,\n      transition: `all ${transitionDuration}ms linear`\n    })\n    if (extraCssText) {\n      div.style.cssText += extraCssText\n    }\n    on(div, 'mouseover', this.mouseover.bind(this))\n    on(div, 'mouseout', this.mouseout.bind(this))\n  }\n\n  mouseover() {\n    this.visible = this.options.enterable\n  }\n\n  mouseout() {\n    this.visible = false\n  }\n\n  destroy() {\n    off(this.tooltipEl, 'mouseover', this.mouseover.bind(this))\n    off(this.tooltipEl, 'mouseout', this.mouseout.bind(this))\n  }\n\n  show(params) {\n    setTimeout(_ => {\n      this.tooltipEl.style.display = 'block'\n      this.tooltipEl.innerHTML = this.getHtml(this.options.formatter, params)\n      this.setPopperPos(params.event, this.tooltipEl, this.options)\n    }, this.options.showDelay)\n  }\n\n  hide(event) {\n    setTimeout(_ => {\n      !this.visible && (this.tooltipEl.style.display = 'none')\n    }, this.options.hideDelay)\n  }\n\n  getHtml(formatter, params) {\n    if (typeof formatter === 'function') return formatter(params)\n    if (!params.data || JSON.stringify(params.data) === '{}') {\n      params.data = { name: params.name }\n    }\n    if (!params.data.value && formatter === defaultOptions.formatter) {\n      formatter = '{name}'\n    }\n    !params.data.name && (params.data.name = params.name)\n    Object.keys(params.data).forEach(key => {\n      formatter = formatter.replace(`{${key}}`, params.data[key])\n    })\n    return formatter\n  }\n\n  setMaxFourValues(value) {\n    if (typeof value === 'number') return `${value}px`\n    if (Array.isArray(value)) return value.map(item => `${item}px`).join(', ')\n    return value\n  }\n\n  setPopperPos(event, el, options = {}) {\n    if (!el) return\n    const { placement = 'right', offset = [20, 20], pointCenter } = options,\n      { offsetX, offsetY } = event,\n      { offsetWidth, offsetHeight } = el,\n      rect = el.parentNode.getBoundingClientRect(),\n      width = el.parentNode.offsetWidth,\n      height = el.parentNode.offsetHeight,\n      pl = offsetX - offsetWidth - offset[0],\n      plc = offsetX - offsetWidth / 2,\n      pr = offsetX + offset[0],\n      pt = offsetY - offsetHeight - offset[1],\n      ptc = offsetY - offsetHeight / 2,\n      pb = offsetY + offset[1]\n    let left, top\n\n    if (placement === 'left') {\n      left = pl < 0 ? pr : pl\n    } else if (placement === 'right') {\n      left = pr + offsetWidth > width ? pl : pr\n    } else if (placement === 'top') {\n      top = pt < 0 ? pb : pt\n    } else if (placement === 'bottom') {\n      top = pb + offsetHeight > height ? pt : pb\n    }\n    if (placement === 'left' || placement === 'right') {\n      if (offsetY + offsetHeight / 2 > height) {\n        pointCenter && (left = plc)\n        top = pt\n      } else if (offsetY - offsetHeight / 2 < 0) {\n        pointCenter && (left = plc)\n        top = pb + offsetHeight > height ? pt : pb\n      } else {\n        top = pointCenter ? ptc : pb\n      }\n    }\n    if (placement === 'top' || placement === 'btottom') {\n      if (offsetX + offsetWidth / 2 > width) {\n        left = pl\n        pointCenter && (top = ptc)\n      } else if (offsetX - offsetWidth / 2 < 0) {\n        left = pr\n        pointCenter && (top = ptc)\n      } else {\n        left = pointCenter ? plc : pr\n      }\n      if (\n        (top === pb && top + offsetHeight > height) ||\n        (top < 0 && top === pt)\n      ) {\n        pointCenter && (top = ptc)\n        left = left + offsetWidth > width ? pl : pr\n      }\n    }\n\n    left < rect.left && (left = pr)\n    top < rect.top && (top = pb)\n    left + offsetWidth + rect.left > window.innerWidth && (left = pl)\n    top + offsetHeight + rect.top > window.innerHeight && (top = pt)\n    setStyles(el, {\n      left: left + 'px',\n      top: top + 'px'\n    })\n  }\n}\n"]}]}